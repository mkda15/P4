\section{The Fourier transform} \label{sec:cont_Fourier_Transform}
This section deals with the continuous Fourier transform. In this project the Fourier transform will be used to transform a signal $f(t)$ represented in the time domain to a signal represented in the frequency domain, which will be useful when making the spectrograms mentioned in chapter \ref{ch1}. The section is inspired by \cite{FourierTrans} and \cite{FAA}.
\\ \\
The Fourier transform is a way of expanding functions on all of $\mathbb{R}$ in the same way that the Fourier series are used to expand functions on a finite interval.

\begin{definition}[The Fourier transform] \label{def:Fourier_trans}
For a function $f \in \mathcal{L}^1$ the Fourier transform of $f$ is defined as follows:
\begin{align*}
\mathcal{F}\{f(t)\}(\omega) = F(\omega) = \int_{-\infty}^\infty f(t) e^{-j \omega t} dt
\end{align*}
\end{definition}

\begin{definition}[The inverse Fourier transform] \label{def:InverseFourier_trans}
For $F \in \mathcal{L}^1$, the inverse Fourier transform of $F(\omega)$ is:
\begin{align*}
\mathcal{F}^{-1}\{F(\omega)\}(t) = f(t) = \frac{1}{2\pi} \int_{-\infty}^\infty F(\omega) e^{j \omega t} d\omega
\end{align*}
\end{definition}

\noindent
As stated in \cite{FourierTrans}, the mathematical importance of the Fourier transform is: \martin{Consider this. \textregistered}
\begin{enumerate}
\item If $f(t)$ has properties that are not desirable (such as discontinuities, non smoothness), then $F(\omega)$ is possibly better behaved.
\item The Fourier transform represents a function that is not necessarily periodic and is defined on an infinite interval. The only requirement for the Fourier transform to exist is that the integral $\int_{-\infty}^\infty |f(t)| dt$ is convergent. The convergence of the Fourier transform is examined later in this chapter.
\end{enumerate}

\noindent
The Fourier transform $F(\omega)$ is a function of frequency and provides information on the amplitude and the phase of the signal at various frequencies. $F(\omega)$ may be written in polar coordinates as $F = |F|e^{j\theta}$ with the modulus $|F|$ representing the amplitude of the signal at a certain frequency $\omega$ and the phase shift $\theta = \arctan \left(\frac{\operatorname{Im}(F)}{\operatorname{Re}(F)} \right)$ at the frequency $\omega$.
\\ \\
The following definition is inspired by \cite{page 206, FAA} and shows a useful tool in both theoretical and applicational aspects.
\begin{definition}[The convolution integral] \label{def:Convol}
Let $f,g$ be functions defined on $\mathbb{R}$. Their convolution is the function $f*g$ defined by:
\begin{align*}
(f*g)(t) = \int_{-\infty}^\infty f(t-\tau) g(\tau) d\tau
\end{align*}

provided that the integral exists.
\end{definition}

\noindent
The following statement shows the symmetry between $f(t)$ and $F(\omega)$ and is inspired by \cite{page 214, FAA}.

\begin{theorem} \label{theorem:fund_sym_Fourier}
Let $f \in \mathcal{L}^1$. Then:

\begin{enumerate}[label=(\alph*)]
\item For any $a \in \mathbb{R}$: \label{theorem:fund_sym_Fourier_a}
\begin{align*}
\mathcal{F}\{f(t-a)\}(\omega) = e^{-ja\omega} F(\omega), \\
\mathcal{F}\{e^{jat}f(t)\}(\omega) = F(\omega - a).
\end{align*}

\item If $\delta > 0$ and $f_\delta(t)=\delta^{-1}f(t/\delta)$, then
\begin{align*}
\mathcal{F}\{f_\delta(t)\}(\omega) = F(\delta\omega), \\
\mathcal{F}\{f(\delta t)\}(\omega) = F_\delta(\omega).
\end{align*}

\item If $f$ is continuous and piecewise smooth and $f' \in L^1$, then
\begin{align*}
\mathcal{F}\{f'(t)\}(\omega) = j\omega F(\omega).
\end{align*}

On the other hand, if $t\cdot f(t)$ is integrable, then
\begin{align*}
\mathcal{F}\{tf(t)\} = j F'(\omega).
\end{align*}

\item If also $g \in L^1$, then
\begin{align*}
\mathcal{F}\{f*g\}(\omega) = F(\omega) \cdot G(\omega).
\end{align*}
\end{enumerate}
\end{theorem}

\begin{proof}
\begin{enumerate}[label=(\alph*)]
\item
By definitions \ref{def:Fourier_trans} and \ref{def:InverseFourier_trans} it follows that:
\begin{align*}
\mathcal{F}\{f(t-a)\}(\omega) = \int_{-\infty}^\infty e^{-j\omega t} f(t - a) dt = \int_{-\infty}^\infty e^{-j\omega t - j\omega a} f(t) dt = e^{-ja \omega} F(\omega).
\end{align*}

For the second equation:
\begin{align*}
\mathcal{F}\{e^{jat} f(t)\}(\omega) = \int_{-\infty}^\infty f(t) e^{jat} e^{-j \omega t} dt = \int_{-\infty}^\infty f(t) e^{j(a- \omega)t} dt = F(\omega - a).
\end{align*}

\item For the first equation, let $\tau = t/\delta$. Hence, $t = \delta \tau$ and $dt = \delta d\tau$, which gives:
\begin{align*}
\mathcal{F}\{f_\delta(t)\}(\omega) &= \int_{-\infty}^\infty f_\delta(t) e^{-j \omega t} dt = \int_{-\infty}^\infty \delta^{-1}f(\tau) e^{-j \omega \delta\tau} \delta d\tau \\
&= \int_{-\infty}^\infty f(\tau) e^{-j \omega \delta\tau} d\tau = F(\delta\omega).
\end{align*}

For the second equation, let $\tau = \delta t$. Hence, $t = \delta^{-1}\tau$ and $dt = \delta^{-1} d\tau$:
\begin{align*}
\mathcal{F}\{f(\delta t)\}(\omega) &= \int_{-\infty}^\infty f(\delta t) e^{-j \omega t} dt = \int_{-\infty}^\infty f(\tau) e^{-j \omega \delta^{-1}\tau} \delta^{-1} d\tau = F_\delta(\omega).
\end{align*}

\item Since $f' \in L^1$, the integral in the limit
\begin{align*}
\lim_{t \to \infty} f(t) = f(0) + \lim_{t\to\infty} \int_0^t f'(x) dx = f(0) + \int_0^\infty f'(x) dx
\end{align*}

is finite, and the whole limit is 0 since $f \in \mathcal{L}^1$ satisfies $\int_{-\infty}^\infty |f(t)| dt < \infty$. Likewise, $\displaystyle{\lim_{t \to -\infty} f(t) = 0}$, too. Integration by parts yields:
\begin{align*}
\mathcal{F}\{f'(t)\}(\omega) &= \int_{-\infty}^\infty e^{-j \omega t} f'(t) dt \\
&= \left[ e^{-j\omega t} f(t) \right]_{-\infty}^\infty - \int_{-\infty}^\infty (-j \omega) e^{-j \omega t} f(t) dt \\
&= \int_{-\infty}^\infty (j \omega) e^{-j \omega t} f(t) dt = j\omega F(\omega)
\end{align*}

since $|e^{-j\omega t}| = 1 \ \forall \ t$ in the second equation. If $tf(t)$ is integrable then:
\begin{align*}
\mathcal{F}\{tf(t)\}(\omega) = \int_{-\infty}^\infty e^{-j \omega t} t f(t) dt = j \dfrac{d}{d\omega} \int_{-\infty}^\infty e^{-j \omega t} f(t) dt = j F'(\omega)
\end{align*}

Note that $t e^{-j \omega t} = j \dfrac{d}{d\omega} e^{-j\omega t}$.

\item Finally, by definition \ref{def:Convol} it follows that:
\begin{align*}
\mathcal{F}\{f*g\}(\omega) &= \int_{-\infty}^\infty \int_{-\infty}^\infty e^{-j \omega t} f(t - \tau) g(\tau) d\tau dt \\
&= \int_{-\infty}^\infty \int_{-\infty}^\infty e^{-j\omega(t-\tau)} f(t-\tau) e^{-j\omega \tau} g(\tau) dt d\tau \\
&= \int_{-\infty}^\infty \int_{-\infty}^\infty e^{-j\omega z} f(z) e^{-j\omega \tau} g(\tau) dz d\tau \\
&= \int_{-\infty}^\infty e^{-j\omega z} f(z) dz \int_{-\infty}^\infty e^{-j\omega \tau} g(\tau) d\tau \\
&= F(\omega) \cdot G(\omega),
\end{align*}

where $z = t - \tau$.
\end{enumerate}
\end{proof}

\noindent
In all simplicity, part (a) of this theorem shows that translating a function (that is, a delay) corresponds to multiplying its Fourier transform by an exponential (which is equivalent to a phase shift since $F$ may be written in the polar coordinates $F = |F|e^{j\theta}$) and vice versa; part (b) shows that dilating a function by $\delta$ corresponds to dilating its Fourier transform by $1/\delta$ and vice versa; part (c) shows that differentiating a function corresponds to multiplying its Fourier transform by the coordinate variable and vice versa; and by definition \ref{def:Convol} it is shown that a convolution in the time domain is equivalent to multiplying in the frequency domain and vice versa \cite{page 215, FAA}.
\\ \\
The following theorem is inspired by \cite{page 77, FAA}. \martin{This is actually related to the Fourier series and the discussion about ortonormal transforms, which we have rather elegantly omitted. We need to consider whether to introduce these (with respect to the limited number of pages). \textregistered}

\begin{theorem} \label{theo:Fourier_series_Parseval}
Let $\{\phi_n\}_1^\infty$ be an orthonormal set in $\mathcal{L}^2(a,b)$. The following conditions are equivalent.
\begin{enumerate}[label=(\alph*)]
\item If $\langle f, \phi_n \rangle = 0$ for all $n$, then $f = 0$.
\item For every $f \in \mathcal{L}^2(a,b)$ we have $f = \sum_1^\infty \langle f, \phi_n \rangle \phi_n$, where the series converges in norm.\\
\item For every $f \in \mathcal{L}^2(a,b)$:
\begin{align*}
\|f\|^2 = \sum_1^\infty |\langle f,\phi_n \rangle|^2
\end{align*}
This is known as Parseval's equation.
\end{enumerate}
\end{theorem}

\begin{proof}
\martin{Prove it or remove it. \textregistered}.
\end{proof}

A main result with regards to the Fourier transform is the following theorem, which is closely related to corollary \ref{coro:conv_Fourier_coeff} from the Fourier series \cite{page 217, FAA}.

\begin{theorem}[The Riemann-Lebesgue Lemma]
If $f \in \mathcal{L}^1$, then $F(\omega) \to 0$ as $\omega \to \pm \infty$.
\end{theorem}

\begin{proof}
$f$ is supposed to be a step function such that $f(t) = \sum_{j=1}^k c_j \phi_j(t)$. $\phi(t)$ is defined as:
\begin{align*}
\phi(t) =
	\begin{cases}
		1 \quad \text{for } |t| < a \\
		0 \quad \text{elsewhere}
	\end{cases}
\end{align*}

Hence, each $\phi_j$ equals 1 on a bounded interval $|t - t_j| < a_j$ and 0 elsewhere. The Fourier transform of $\phi(t)$ is:
\begin{align*}
\mathcal{F}\{\phi(t)\}(\omega) = \int_{-a}^a e^{-j\omega t} dt = \dfrac{e^{-ja\omega} - e^{ja\omega}}{-j\omega} = 2\dfrac{\sin(a\omega)}{\omega}.
\end{align*}

By theorem \ref{theorem:fund_sym_Fourier}\ref{theorem:fund_sym_Fourier_a}, the Fourier transform of $\phi_j(t)$ is:
\begin{align*}
\mathcal{F}\{\phi_j(t)\}(\omega) = 2 \omega^{-1} e^{-jt_j\omega} \sin(a_j\omega),
\end{align*}

which vanishes when $\omega to \infty$, and hence so does $F(\omega)$.
\\
In the general case it is possible to find a sequence $\{f_n\}, f \in \mathcal{L}^1$ of step functions such that
\begin{align*}
\int_{-\infty}^\infty |f_n(t) - f(t)| dt \to 0.
\end{align*}

When $f$ is Riemann integrable this is simply a restatement of the fact that the integral of $f$ is the limit of Riemann sums. When $f$ is Lebesgue integrable the proof requires results from integration theory, which are omitted in this project. Since $|e^j\omega t| = 1$, the integral in the Fourier transform converges absolutely for all $\omega$ and defines a bounded function of $\omega$:
\begin{align*}
|F(\omega)| \leq \int_{-\infty}^\infty |f(t)| dt,
\end{align*}

which means that:
\begin{align*}
\sup_{\omega} |F_n(\omega) - F(\omega)| \leq \int_{-\infty}^\infty |f_n(t) - f(t)| dt \to 0 \quad \text{as } n \to \infty.
\end{align*}

Therefore, $F_n(\omega) \to F$ uniformly, and since each $F_n(\omega)$ vanishes at infinity, then so does $F(\omega)$.
\end{proof}

Moreover, the Fourier transform $F(\omega)$ is well-defined for $f \in \mathcal{L}^1$ since
\begin{align*}
|F(\omega)| \leq \int_{-\infty}^\infty |f(t)| \cdot |e^{j \omega t}| dt = \|f\|_{\mathcal{L}^1} < \infty.
\end{align*}

However, $F$ is not guaranteed to be in $\mathcal{L}^1$, which means the inverse Fourier transform might not be applicable. This is the reason why the space $\mathcal{L}^2$ also plays a significant role for Fourier transforms. If $f, g, F, G \in \mathcal{L}^1$ then $f$, $g$, $F$ and $G$ are also in $\mathcal{L}^2$ \cite{page 219, FAA}. By the definitions in chapter \ref{ch4} it follows that
\begin{align*}
2\pi \langle f,g \rangle = 2\pi \int_{-\infty}^\infty f(t) \overline{g(t)} dt &= \int_{-\infty}^\infty \int_{-\infty}^\infty f(t) \overline{e^{j\omega t} G(\omega)} d\omega dt \\
&= \int_{-\infty}^\infty \int_{-\infty}^\infty f(t) e^{-j\omega t} \overline{G(\omega)} dt d\omega \\
&= \int_{-\infty}^\infty F(\omega) \overline{G(\omega)} d\omega = \langle F,G \rangle.
\end{align*}

Therefore, the Fourier transform preserves inner products up to a factor of $2\pi$. By taking $f = g$ it is seen that:
\begin{align*}
2\pi \langle f,f \rangle = \langle F,F \rangle \Rightarrow 2\pi \|f\|^2 = \|F\|^2.
\end{align*}

If $f$ is an arbitrary function in $\mathcal{L}^2$ it is possible to find a sequence $\{f_n\}$ such that $f_n$ and $F_n$ are in $\mathcal{L}^1$ and $f_n$ converges to $f$ in $\mathcal{L}^2$ \cite{page 82, FAA}. Since $\|F_n - F_m\|^2 = 2\pi\|f_n - f_m\|^2$, which converges to 0 as $m,n$ converges to $\infty$, $\{F_n\}$ is a Cauchy sequence in $\mathcal{L}^2$, which has a limit since $\mathcal{L}^2$ is complete. This limit only depends on $f$ and not on $\{f_n\}$, and it is simply defined to be the Fourier transform $F$. The domain of the Fourier transform is thus extended to include all of $\mathcal{L}^2$. This extension still preserves the norm and inner product up to a factor of $2\pi$, and it also satisfies the basic properties of the Fourier transform stated in theorem \ref{theorem:fund_sym_Fourier}. These results are stated below \cite{page 222, FAA}.

\begin{theorem}[The Plancherel Theorem] \label{Plancherel}
The Fourier Transform, defined originally on $\mathcal{L}^1 \cap \mathcal{L}^2$, extends uniquely to the invertible map $\mathcal{F}: \mathcal{L}^2 \to \mathcal{L}^2$, where $F = \mathcal{F}\{f\}, G = \mathcal{F}\{g\}$, that satisfies:
\begin{align*}
\langle F, G \rangle = 2\pi \langle f,g \rangle \\
\|F\|^2  = 2\pi \|f\|^2
\end{align*}
for all $f,g \in \mathcal{L}^2$.
\end{theorem}